<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Gravação</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="min-h-screen p-4 md:p-8">
    <div class="max-w-3xl mx-auto grid gap-6">
      <header>
        <h1 class="text-2xl md:text-3xl font-bold">Calculadora de Gravação</h1>
      </header>

      <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-200 grid gap-4">
        <div>
          <label class="block text-sm mb-1">Tipo de gravação</label>
          <select id="tipo" class="w-full rounded-xl border border-gray-200 px-3 py-2">
            <option value="podcast">Podcast / Curso</option>
            <option value="clipe">Clipes / Outros</option>
          </select>
        </div>

        <div>
          <label class="block text-sm mb-1">Quantidade de horas</label>
          <input id="horas" type="number" min="1" value="1"
                 class="w-full rounded-xl border border-gray-200 px-3 py-2" />
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm mb-1">Cortes p/ redes sociais</label>
            <input id="cortesRedes" type="number" min="0" value="0"
                   class="w-full rounded-xl border border-gray-200 px-3 py-2" />
          </div>
          <div>
            <label class="block text-sm mb-1">Cortes p/ YouTube</label>
            <input id="cortesYoutube" type="number" min="0" value="0"
                   class="w-full rounded-xl border border-gray-200 px-3 py-2" />
          </div>
        </div>
      </div>

      <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-200">
        <h2 class="font-semibold mb-2">Resumo</h2>
        <div id="detalhes" class="space-y-1 text-sm"></div>
        <hr class="my-2" />
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-600">Cortes</span>
          <span id="valorCortes">R$ 0,00</span>
        </div>
        <hr class="my-2" />
        <div class="flex items-center justify-between">
          <span class="text-gray-600 text-base">Total</span>
          <span id="total" class="font-semibold text-lg">R$ 0,00</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    const brl = new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" });
    const $ = (id) => document.getElementById(id);

    function calcularValorBase(tipo, horas) {
      if (horas <= 0) return { valor: 0, ciclos: [] };

      let total = 0;
      let horasRestantes = horas;
      let cicloN = 1;
      const ciclos = [];

      while (horasRestantes > 0) {
        let subtotal = 0;
        // primeira hora do ciclo (7ª hora volta a ser 1ª de um novo ciclo)
        subtotal += (tipo === "podcast") ? 700 : 1000;
        horasRestantes -= 1;

        // até 5 horas adicionais nesse ciclo (limite de 6h por ciclo)
        const adicionais = Math.min(5, horasRestantes);
        subtotal += adicionais * ((tipo === "podcast") ? 500 : 700);
        horasRestantes -= adicionais;

        ciclos.push({ nome: `Ciclo ${cicloN}`, valor: subtotal });
        cicloN++;
        total += subtotal;
      }

      return { valor: total, ciclos };
    }

    function atualizar() {
      const tipo = $("tipo").value;
      const horas = Math.max(1, parseInt($("horas").value) || 1);
      const cortesRedes = Math.max(0, parseInt($("cortesRedes").value) || 0);
      const cortesYoutube = Math.max(0, parseInt($("cortesYoutube").value) || 0);

      const base = calcularValorBase(tipo, horas);
      const valorCortes = (cortesRedes * 150) + (cortesYoutube * 200);
      const total = base.valor + valorCortes;

      // Detalhes dos ciclos
      const detalhesEl = $("detalhes");
      detalhesEl.innerHTML = base.ciclos.map(c =>
        `<div class="flex justify-between"><span class="text-gray-600">${c.nome}</span><span>${brl.format(c.valor)}</span></div>`
      ).join("");

      $("valorCortes").textContent = brl.format(valorCortes);
      $("total").textContent = brl.format(total);
    }

    // Eventos
    ["tipo","horas","cortesRedes","cortesYoutube"].forEach(id => {
      $(id).addEventListener("input", atualizar);
      $(id).addEventListener("change", atualizar);
    });

    // Inicial
    atualizar();
  </script>
</body>
</html>
